services:
  # 1) Backend (Spring Boot)
  - type: web
    name: staybooking-backend
    env: java
    rootDir: backend
    plan: free
    buildCommand: ./mvnw clean package -DskipTests
    startCommand: java -jar target/*.jar
    autoDeploy: true

  # 2) Frontend (Vite -> static)
  - type: static_site
    name: staybooking-frontend
    rootDir: .
    plan: free
    buildCommand: npm ci && npm run build
    staticPublishPath: dist
    autoDeploy: true
    routes:
      # SPA fallback
      - type: rewrite
        source: /*
        destination: /index.html
